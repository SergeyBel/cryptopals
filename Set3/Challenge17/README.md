Задание знакомит нас с Oracle Padding Attack на режим CBC блочного шифра  

Атака позволяет восстановить открытый текст, имея только зашифрованный текст и доступ к оракулу  
Оракул представляет собой блочный шифр в режиме CBC с паддингом. При этом оракул, в случае, если паддинг при расшифровке получился некорректный, возвращает ошибку "Неверный паддинг".
Это свойство и позволяет восстановить открытый текст. В задании рассматривается блочный шифр AES-CBC и паддинг Pkcs7  



## Общая идея 
Расшифрование в режиме CBC проводится по следующему правилу:  
$P_i = C_{i - 1} \oplus D_k(C_i), C_0 = IV$  
Обозначим $I_i = D_k(C_i)$, тогда $P_i = C_{i - 1} \oplus I_i$  
Если  $I_i$ известно, то легко расшифровать сообщение (поскольку $C_{i - 1}$ известно )  


## Расшифровка последнего байта блока
Пусть мы хотим расшифровать блок $C$  шифротекста. Расшифровавыть будем побайтово, начиная с последнего байта
Возьмём блок $B$ у которого значения 
$B[0],...,B[14]$ зафиксируем, а последний байт будем перебирать  
Постоим сообщение $B|C$ и отправим его на расшифровку оракулу.   

$P = B \oplus D_k(C) = B \oplus I$, следовательно  $P[15] = B[15] \oplus I[15]$  
Корретное для паддинга значение $P[15]$ = 0x01 (по правилу паддинга одного байта Pkcs7), если байт будет иметь другое значение, то оракул вернёт ошибку "Неверный паддинг"  
Если же байт будет иметь значение 0x01, то оракул не вернёт ошибку. В этом случае  
$I[15] = B[15] \oplus P[15] = B[15] \oplus 0x01$  
т.е мы получаем $I[15]$, а значит можем восстановить байт исходного текста


## Расшифровка остальных байтов
Для двух байтов правильный паддинг будет 0x02, 0x02, чтобы восстановить $I[14]$ мы формируем блок $B$:  
$B[0]$,...,$B[13]$ - произвольные значения  
$B[15] = I[15] \oplus 0x02$  
$B[14]$ - перебираем    
И посылаем на вход оракулу сообщения вида $B|C$. В случае, когда оракул не выдаст ошибку "Неверный паддинг" вычисляем $I[14] = B[14] \oplus 0x02$

Продолжая аналогично для остальных байтов блока, мы расшифровываем блок полностью, а значит и сообщение блок за блоком




