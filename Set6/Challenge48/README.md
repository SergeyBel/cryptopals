Задание посвящено атаке Bleichenbacher's PKCS 1.5  

## Формат PKCS 1.5   
Используется RSA с параметрами e, d, n. Длина n в байтах равна k   
Если нужно передать сообщение data длины d байт, то сообщение PKCS 1.5 будет выглядеть так
00h 02h padding 00h data, где:
00h 02h  - фиксированное начало  
padding - заполнение случайными ненулевыми байтами длины k - 3 - D  
00h - нулевой байт - признак начала данных  
data - данные  
Общая длина сообщения равно в точности k 

Сообщение превращается в целое число $m_0$ и шифруется $c = m_0^e \pmod n$


## Общая идея  
Атака основана на оракуле, который возникает, если при расшифровке сообщения и парсинге в случае, если два первых байта не равны 00h 02h сразу выдаётся ошибка, по которой можно определить этот случай
Тогда в случае наличия этой ошибки, мы знаем, что первые два байта расшифрованного сообщения не равны 00h 02h, а в случае отстствия, что они равны 00h 02h (в этом случае будет говорить, что оракул опознал сообщение)


Обозначим $B = 2^{8(k-2)}$  в виде байт $B$ будет иметь вид 00h 01h 00h ... 00h  
Так как в сообщении $m_0$ первые два байта равны 00h 02h, то известно, что
1. $2B \le m_0$, так как $2B$ имеет вид 00h 02h 00h ... 00h
2. $m_0 /ge 3B$, так как $3B$ имеет вид 00h 03h 00h ... 00h 

$2B \le m_0 \le 3B$  

Зная $c$ мы можем составить сообщение $c_1 = m_1^d \pmod n = (m_0 * s)^e \pmod(n) = c * s^e \pmod n$  
Если оракул опознал сообщение $c_1$, то первые два байта в $m_1 = c_1 ^ d \pmod n$ равны 00h 02h, тогда
$2B \le m_1 \le 3B$  
$2B \le m_0s - rn \le 3B$ для целых r  
$(2B + rn) / s \le m_0 \le (3B + rn) / s$  
Что даёт новые ограничения для $m_0$. Эти ограничения уточняют исходное ограничение $2B \le m_0 \le 3B$      

В то же время $r = (m_0s - m_1) / n$, а значит  
$r \le (3Bs - 2B) / n$ , это значение больше 1 только при $s  \ge n / (3B)$, что даёт нижнюю границу для s 












